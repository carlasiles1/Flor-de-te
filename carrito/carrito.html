<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://kit.fontawesome.com/b58110c1d4.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../inicio/inicio.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <title>Flor de Té</title>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <link rel="stylesheet" href="../inicio/estilo_popup.css">
      <link rel="stylesheet" href="carrito.css">
      <link rel="stylesheet" href="../inicio/inicio.css">

  </head>
<body>

  <nav class="menu">
    <div class="left-section">
      <img
        src="../img/logos/logo_horizontal.svg"
        alt="logo Flor de Té"
        class="logo"
      />
      <ul>
        <li><a href="../inicio/index.html" data-translate="inicio">Inicio</a></li>
        <li><a href="../catalogo/catalogo.html" data-translate="catalogo-nav">Catálogo</a></li>
        <li><a href="../nosotros/nosotros.html" data-translate="nosotros">Nosotros</a></li>
        <li><a href="../contacto/contacto.html" data-translate="contacto">Contacto</a></li>
      </ul>
    </div>
    <div class="right-section">
      <input type="text" placeholder="Buscar..." />
      <div class="user-area"><i class="fa-solid fa-user"></i></div>
      <div class="cart"><i class="fa-solid fa-cart-shopping"></i></div>
      <select title="idioma">
        <option value="es">ES</option>
        <option value="en">EN</option>
      </select>
    </div>
    <div id="fechayhora"></div> <!--reubicar este div-->
  </nav>
 
  <main>
    <div class="separador"></div>
  <section class="carrito_section">
    <p class="saludoCliente"><span>Juan Carlos</span>, estos son los productos de tu carrito:</p>
   
    <ul id="carrito_container" style="display: flex;" class="carrito_container"></ul>
  </section>

<!------------------------------------->

<!-- Precios -->
 <section> 
<div id="cart-summary">
  <p class="precioTotal"><b>Total: <span id="total"></span>€</b></p>
  <p>Subtotal: <span id="subtotal"></span>€</p>
  <p>IVA: <span id="iva"></span>€</p>
  <button id="finalizarCompra">Confirmar compra</button>
  
</div>

<!------------------------------------->
</section>
</main>

<footer>
  <div class="footer-container">
    <div class="comercio-justo">
      <p><i class="fa-solid fa-handshake"></i> Comercio Justo</p>
      <p><i class="fa-solid fa-seedling"></i> Sin crueldad animal</p>
      <p><i class="fa-solid fa-leaf"></i> 100% Orgánico</p>
      <p><i class="fa-solid fa-trash"></i> Sin microplasticos</p>
    </div>
    <hr class="linea-fina">
    <div class="newsletter">
      <h3>Suscríbete a nuestra newsletter</h3>
      <p>Ofertas, novedades y descuentos exclusivos. ¿Te lo vas a perder?</p>
      <form>
        <input type="email" placeholder="Introduce tu email">
        <button type="submit">Suscribirse</button>
      </form>
      <div class="social-media">
        <a href="#"><i class="fab fa-tiktok"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
        <a href="#"><i class="fab fa-facebook"></i></a>
      </div>
    </div>
    <div class="footer-columns">
      <div class="footer-column">
        <h4>Enlaces Útiles</h4>
        <p>
          <a href="index.html">Inicio</a>
          <a href="nosotros.html">Nosotros</a>
          <a href="contacto.html">Contacto</a>
          <a href="carrito.html">Carrito</a>
        </p>
      </div>
      <div class="footer-column">
        <h4>Políticas</h4>
        <p>
          <a href="#">Políticas</a>
          <a href="#">Aviso Legal</a>
          <a href="#">Política de Cookies</a>
          <a href="#">Políticas de Privacidad</a>
        </p>
      </div>
    </div>
  </div>
  <div class="subfooter">
    <p>© 2024 Flor de Té</p>
  </div>
</footer>


<script>

document.addEventListener('DOMContentLoaded', () => {
  const carritoDestino = document.getElementById('carrito_container'); 

  const carritoGuardado = localStorage.getItem('carritoLleno');

  if (carritoDestino && carritoGuardado) {
    
    carritoDestino.innerHTML = carritoGuardado;
  }
});

setTimeout(obtenerPrecio, 100);
setTimeout(borrarProducto, 100);

function obtenerPrecio() { 
    let sumaTotal = 0;
    let subTotal = 0;
    let ivaTotal = 0;

    const precios = document.querySelectorAll(".precio");
    const montos = document.querySelectorAll(".monto");

    // Extraer los valores numéricos de montos
    const numeros = Array.from(montos).map(monto => {
        const match = monto.innerText.match(/\d+/); // Busca un número en el texto
        return match ? parseInt(match[0], 10) : 1; // Si no encuentra un número, usa 1 como valor predeterminado
    });

    // Iterar sobre los precios y multiplicar por los montos correspondientes
    precios.forEach((elemento, index) => {
        const precio = parseFloat(elemento.innerText); 
        const monto = numeros[index] || 1; // Si no hay un monto, asumir 1 como predeterminado

        if (!isNaN(precio)) { 
            sumaTotal += precio * monto; // Multiplicar precio por monto
        } 
    });

    // Calcular IVA y subtotal
    ivaTotal = sumaTotal * 0.21;
    subTotal = sumaTotal - ivaTotal;

    // Actualizar los valores en el DOM
    const total = document.getElementById("total");
    total.innerText = sumaTotal.toFixed(2); // Con 2 decimales

    const total2 = document.getElementById("iva");
    total2.innerText = ivaTotal.toFixed(2);

    const total3 = document.getElementById("subtotal");
    total3.innerText = subTotal.toFixed(2);
}

function borrarProducto(){

  const papelera = document.querySelectorAll(".carrito_container li span");
  
  papelera.forEach(item => {
    item.addEventListener('click', function() {
      
      item.setAttribute("cursor", "pointer");

      /* anadirProducto.remove();*/
      item.parentNode.remove();
      obtenerPrecio()

    });
  });

}
  </script>

<script src="../inicio/fechayhora.js"></script>
<script> scr="../catalogo/inicio.js"</script>

</body>
</html>